# Works

Here we describe the works done with the codes in this directory.

1. `QSO_box_z3`: as the first test. Use the prior of $p$ estimated from the 100 HOD sampled from the posterior of `base-A` HOD model. However, the data is the best-fit HOD of `base` HOD model. The results $f_{\rm NL}=132\pm 17$ show a 2$\sigma$ bias in the inferred $f_{\rm NL}$. Since the $p$ we measured from the 'data' mock is $1.19\pm 0.35$, and the central value we used for prior is ~2$\sigma$ biased.
2. `QSO_box_z3_base-A`: the first 'serious' work. Use the prior of $p$ estimated from the 100 HOD sampled from the posterior of `base-A` HOD model, and the data from the best-fit `base-A` HOD model. The results $f_{\rm NL}=109\pm 18$ are consistent with the true value $f_{\rm NL}=100$. The $p$ we measured from the 'data' mock is $1.83\pm 0.34$, which is with in the 1$\sigma$ range of the prior we used, $1.884\pm 0.1056$.
3. `QSO_box_z3_base-A_3sigma`: similar to the previous work, but we use a broader prior of $p$, with 3 times the sigma of the previous prior. The results $f_{\rm NL}=111^{+18}_{-30}$ are also consistent with the true value $f_{\rm NL}=100$, but with a larger uncertainty due to the broader prior. In this case, we found there is a small peak arounc $p ~ 5$ and $f_{\rm NL} < 0$ in the posterior distribution, which is caused by the degeneracy between $b_{\phi}$ and $f_{\rm NL}$, so we add a hard prior $0 < p < 4$ to remove this unphysical peak.  
4. `QSO_box_z3_base-A_100chains`: similar to the previous work, but the HIP of $p$ is estimated by combining 100 chains of the HOD samples, $p=1.91\pm 0.36$, which considers both the uncertainties from the HOD posterior and from the $p$-inferences. The results $f_{\rm NL}=113^{+19}_{-31}$ are also consistent with the true value $f_{\rm NL}=100$.
5. `QSO_box_z3_base-A_100chains_correctEZ`: Just found previous 3 works (2-4) used a set of EZmocks with too large $f_{\rm NL}$ for the base-A bestfit. The results $f_{\rm NL}=110^{+17}_{-31}$ does not change much after correcting this issue -- slightly better, but the main reason of the ~0.3 $\sigma$ bias should be the over-estimation of $p$ from the HIP samples.
6. `QSO_box_z3_base-A_MAP`: use the $p$-prior measured from the MAP mock, $p=1.83\pm 0.34$. The results $f_{\rm NL}=105^{+17}_{-27}$ show less bias, but generally consistent with previous works. (The $~0.2\sigma$ bias could be the accuracy of the covariance? need to be test...)
7. `QSO_box_z3_base-A_fixp1.4`: fix $p=1.4$ as it's the fiducial choice of the KP. The true value $f_{\rm NL}=100$ are $~1.3\sigma$ away from the results $f_{\rm NL}=86^{+11}_{-12}$, showing that fixing $p$ to a lower value products both lower central value and error-bar of $f_{\rm NL}$.
8. `QSO_box_z3_base-A_fixp1.6`: fix $p=1.6$ as it's the fiducial choice of the DR1. The true value $f_{\rm NL}=100$ are $~0.54\sigma$ away from the results $f_{\rm NL}=93\pm 13$, the under-estimation is mild.
9. `QSO_box_z3_base-A_100chains_thecov`: similar to work 4, but using the covariance estimated from the mock itself (thecov_box). The results $f_{\rm NL}=106^{+18}_{-30}$ are consistent with the true value $f_{\rm NL}=100$, showing less bias than work 4 and 5, but not much.
10. `QSO_box_z3_base-A_MAP_thecov`: similar to work 6, but using the covariance estimated from the mock itself (thecov_box), this is also the covariance used to generate the $p$-prior. The results $f_{\rm NL}=101^{+17}_{-27}$ are nearly unbiased. Comparing this work to work 6 shows the influence from the covariance in $f_{\rm NL}$ inference, our conclusion is that the influence is small ($\sim 0.15 \sigma$).
11. `QSO_box_z3_base-A_ph001_thecov`: test our $p$-prior on the other realization `ph001` with the MAP HOD parameters from `ph000`. The results $f_{\rm NL}=97^{+16}_{-27}$ are nearly unbiased, showing the robustness of our $p$-prior.
12. `QSO_box_z3_base-A_ph000_thecov`: similar to work 9, but reproduce the AbacusHOD mock with the MAP of the chain used to estimate the $p$-prior (just found that previous tests used the MAP of a HOD chain in newer version). The results $f_{\rm NL}=105^{+18}_{-29}$ do not change much.
13. `QSO_box_z3_base-A_c300_thecov`: test our $p$-prior $p=1.91\pm 0.36$ on $f_{\rm NL}=30$ simulation `c300_ph000` MAP AbacusHOD mock. The results $f_{\rm NL}=39^{+9.9}_{-14}$ are consistent with the true value $f_{\rm NL}=30$ ($\sim 0.64\sigma$ biased).
14. `QSO_box_z3_base-A_c300_thecov_fixp1.6`: same as work 13, but fix $p=1.6$. The results $f_{\rm NL}=33.9^{+9.1}_{-8.0}$ are consistent with the true value $f_{\rm NL}=30$ ($\sim 0.48\sigma$ biased).
15. `QSO_box_z3_base-A_c300_thecov_fixp1.4`: same as work 13, but fix $p=1.4$. The results $f_{\rm NL}=31.2^{+7.8}_{-8.3}$ are consistent with the true value $f_{\rm NL}=30$ ($\sim 0.14\sigma$ biased).
16. `QSO_box_z3_base-A_ph001_thecov_fixp1.4`: same as work 11, but fix $p=1.4$. The results $f_{\rm NL}=77^{+11}_{-12}$ are $\sim 2\sigma$ lower than the true value $f_{\rm NL}=100$.
17. `QSO_box_z3_base-A_ph001_thecov_fixp1.6`: same as work 11, but fix $p=1.6$. The results $f_{\rm NL}=83^{+12}_{-13}$ are $\sim 1.4\sigma$ lower than the true value $f_{\rm NL}=100$.